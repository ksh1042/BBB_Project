<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="FinanceDetail">
	
	<select id="getFinanceDetailSeqNextValue" resultType="int">
		select fnum_seq.nextval from dual
	</select>
	
	<select id="selectFinanceDetailList" resultType="financeDetail">
		select *
		from tbl_finance_detail fd, tbl_project p
		where fd.fnum=p.fnum and fd.fnum=#{fNum}
	</select>
	
	<select id="selectFinanceDetailByFnum">
		select *
		from tbl_finance_detail
		where fnum=#{fNum}
	</select>
	
	<update id="insertFinanceDetail" parameterType="financeDetail">
		insert into tbl_finance_detail(fnum, targetname, content, price, writer, deposityn, regdate)
		values(fnum_seq.nextval, #{targetName}, #{content}, #{price}, #{writer}, #{depositYn}, #{regDate})
	</update>
	
	<select id="selectRegdateByFnum" resultType="financeDetail">
		select regdate
		from tbl_finance_detail
		where fnum=#{fNum}
		group by regdate
		order by regdate asc
	</select>
	
	<select id="selectFinanceByPricePlus" resultType="int">
		select sum(price)
		from tbl_finance_detail
		where deposityn=1 and fnum=#{fNum}
	</select>
	<select id="selectFinanceByPriceMinus" resultType="int">
		select sum(price)
		from tbl_finance_detail
		where deposityn=0 and fnum=#{fNum}
	</select>
</mapper>
